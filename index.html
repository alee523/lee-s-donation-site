<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù…Ø¨Ø§Ø¯Ø±Ø© Ø³ÙˆØ§ Ø¨Ù†ØªØ®Ø·Ù‰</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    /* ----------- Ù†ÙØ³ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ù„ÙŠ Ø¹Ù†Ø¯Ùƒ ----------- */
    html, body { height: 100%; margin: 0; font-family: 'Arial', sans-serif; }
    .poster-container { position: relative; width: 100%; min-height: 100%; background-color: #222; text-align: right; direction: rtl; overflow: hidden; }
    .background-image { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-image: url('students.jpg'); background-size: cover; background-position: center top; opacity: 0.5; z-index: 1; }
    .content { position: relative; z-index: 10; color: white; padding: 40px 20px; }
    .main-title { font-size: 2.4em; font-weight: bold; margin-bottom: 20px; color: #F8B400; text-align: center; }
    .description { font-size: 1.3em; line-height: 1.8; margin-bottom: 30px; background-color: rgba(0,0,0,0.5); padding: 15px; border-radius: 8px; }
    .highlight { color: #FFD700; font-weight: bold; }
    .donation-details { margin: 30px 0; }
    .section { border-bottom: 1px solid rgba(255, 255, 255, 0.3); padding: 15px 0; }
    .section-title { font-size: 1.4em; font-weight: bold; display: inline-block; margin-right: 10px; }
    .icon { font-size: 1.6em; color: #F8B400; vertical-align: middle; margin-left: 8px; }
    .details { font-size: 1.2em; margin-top: 5px; }
    .copy-btn { margin-right: 10px; padding: 3px 8px; font-size: 0.9em; border: none; border-radius: 4px; background-color: #F8B400; color: black; cursor: pointer; transition: background 0.3s; }
    .copy-btn:hover { background-color: #FFD700; }
    .donate-button { display: block; width: 60%; margin: 30px auto; background-color: #FFD700; color: black; text-align: center; padding: 15px 25px; font-size: 1.5em; font-weight: bold; text-decoration: none; border-radius: 5px; transition: all 0.3s ease; }
    .donate-button:hover { background-color: #F8B400; transform: scale(1.05); }
    .footer { position: relative; bottom: 0; left: 0; right: 0; padding: 10px; background-color: rgba(0, 0, 0, 0.7); z-index: 10; }
    .contact-info { text-align: center; font-size: 0.9em; margin-bottom: 5px; color: #F8B400; }
    .tagline { text-align: center; font-size: 0.9em; color: #F8B400; }
    @media (max-width: 768px) { .main-title { font-size: 2em; } .description { font-size: 1em; } .donate-button { width: 80%; font-size: 1.2em; } }
    .whatsapp-float { position: fixed; width: 55px; height: 55px; bottom: 20px; left: 20px; background-color: #F8B400; color: white; border-radius: 50%; text-align: center; font-size: 28px; box-shadow: 0 2px 5px rgba(0,0,0,0.3); z-index: 9999; line-height: 55px; text-decoration: none; transition: transform 0.3s ease; }
    .whatsapp-float:hover { transform: scale(1.1); }
    /* --------- Ù…ÙˆØ¯Ø§Ù„ --------- */
    .modal { display: none; position: fixed; z-index: 1000; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); justify-content: center; align-items: center; }
    .modal-content { background: #fff; border-radius: 12px; padding: 20px; width: 90%; max-width: 500px; position: relative; }
    .close { position: absolute; top: 10px; left: 10px; font-size: 20px; cursor: pointer; }
    .tabs { display: flex; gap: 8px; justify-content: center; margin: 20px 0; }
    .tab { flex: 1; text-align: center; padding: 10px; cursor: pointer; background: #eee; border-radius: 8px; font-weight: 600; }
    .tab.active { background: #007bff; color: white; }
    form { display: none; }
    form.active { display: block; }
    label { display: block; margin: 8px 0 4px; font-weight: 600; color: #FFD700; }
    input[type="text"], input[type="number"], input[type="file"] { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 6px; margin-bottom: 10px; }
    button[type="submit"] { background:#F8B400; color:#000; font-weight:600; padding:10px 15px; border:none; border-radius:6px; cursor:pointer; width:100%; }
  </style>
</head>
<body>
  <div class="poster-container">
    <div class="background-image"></div>
    <div class="content">
      <h1 class="main-title">ğŸ“šâœ¨ Ù…Ø¨Ø§Ø¯Ø±Ø© "Ø³ÙˆØ§ Ø¨Ù†ØªØ®Ø·Ù‰" Ù„Ø¯Ø¹Ù… Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ø­ØªØ§Ø¬ÙŠÙ† âœ¨ğŸ“š</h1>
      <p class="description">
        Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡ Ø§Ù„Ø°ÙŠ ÙˆÙÙ‚Ù†Ø§ ÙˆØ£Ø¹Ø§Ù†Ù†Ø§ Ø¹Ù„Ù‰ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù…ØªØ­Ø§Ù†Ø§ØªÙ†Ø§ Ø±ØºÙ… Ø§Ù„Ø¸Ø±ÙˆÙ Ø§Ù„ØµØ¹Ø¨Ø©ØŒ ÙˆÙ†Ø­Ù† Ø§Ù„Ø¢Ù† Ø¹Ù„Ù‰ Ø£Ø¹ØªØ§Ø¨ Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© 2022 â€“ 2023 Ù…ØªÙ…Ù†ÙŠÙ† Ø£Ù† ØªÙƒÙˆÙ† Ø³Ù†Ø© Ø®ÙŠØ± ÙˆØªÙˆÙÙŠÙ‚ Ù„Ù„Ø¬Ù…ÙŠØ¹ ğŸ’™<br><br>
        Ù„ÙƒÙ† Ù„Ù„Ø£Ø³ÙØŒ Ù…Ø¹ Ù‚Ø±Ø¨ Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø£ÙˆØ¶Ø­Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:<br>
        ğŸ”¹ Ù„Ù† ÙŠÙƒÙˆÙ† Ù‡Ù†Ø§Ùƒ Ø£ÙŠ ØªØ£Ø¬ÙŠÙ„ Ø£Ùˆ Ø§Ø³ØªØ«Ù†Ø§Ø¡ Ù„Ù„Ø·Ù„Ø§Ø¨ ØºÙŠØ± Ø§Ù„Ù…Ø³Ø¯Ø¯ÙŠÙ† Ù„Ù„Ø±Ø³ÙˆÙ….<br>
        ğŸ”¹ Ø£ÙŠ Ø·Ø§Ù„Ø¨ Ù„Ù… ÙŠØ³Ø¯Ø¯ Ø³ÙŠØªÙ… ÙØµÙ„Ù‡ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ø¹Ø¯ Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ù†ØªÙŠØ¬Ø©.<br><br>
        ÙˆÙ‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø± Ù…Ø¤Ù„Ù… Ø¬Ø¯Ù‹Ø§ØŒ Ù„Ø£Ù† Ù‡Ù†Ø§Ùƒ Ø¹Ø¯Ø¯Ù‹Ø§ ÙƒØ¨ÙŠØ±Ù‹Ø§ Ù…Ù† Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ø¬ØªÙ‡Ø¯ÙˆØ§ ÙˆØªØ¹Ø¨ÙˆØ§ ÙÙŠ Ø¸Ø±ÙˆÙ Ù‚Ø§Ø³ÙŠØ©ØŒ ÙˆÙ„Ø§ ÙŠØ³ØªØ­Ù‚ÙˆÙ† Ø£Ù† ÙŠÙØ­Ø±Ù…ÙˆØ§ Ù…Ù† Ù…ÙˆØ§ØµÙ„Ø© Ø¯Ø±Ø¨Ù‡Ù… Ø¨Ø³Ø¨Ø¨ Ø§Ù„Ø¸Ø±ÙˆÙ Ø§Ù„Ù…Ø§Ø¯ÙŠØ©.<br><br>
        âœŠ Ù„Ø°Ù„Ùƒ Ø£Ø·Ù„Ù‚Ù†Ø§ Ù…Ø¨Ø§Ø¯Ø±Ø©:<br>
        ğŸŒŸ <span class="highlight">"Ø³ÙˆØ§ Ø¨Ù†ØªØ®Ø·Ù‰"</span> ğŸŒŸ<br>
        Ù„Ù†Ù‚Ù Ù…Ø¹ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ø­ØªØ§Ø¬ÙŠÙ† ÙˆÙ†Ø¬Ù…Ø¹ Ø§Ù„ØªØ¨Ø±Ø¹Ø§Øª Ù„Ø¯ÙØ¹ Ø±Ø³ÙˆÙ…Ù‡Ù…ØŒ ÙˆØ£ÙŠ Ù…Ø³Ø§Ù‡Ù…Ø© Ù…Ù‡Ù…Ø§ ÙƒØ§Ù†Øª Ø¨Ø³ÙŠØ·Ø© Ù‚Ø§Ø¯Ø±Ø© ØªØµÙ†Ø¹ ÙØ±Ù‚Ù‹Ø§ ÙƒØ¨ÙŠØ±Ù‹Ø§ ğŸ™<br><br>
        ğŸ’¡ Ø®Ù„ÙˆÙ†Ø§ Ù†ÙƒÙˆÙ† Ø³Ø¨Ø¨ ÙÙŠ ÙØ±Ø­Ø© Ø·Ø§Ù„Ø¨â€¦ ÙˆÙÙŠ Ø§Ø³ØªÙ…Ø±Ø§Ø±Ù‡ Ù†Ø­Ùˆ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„.
      </p>


      <div class="donation-details">
        <div class="section"><span class="icon">ğŸ¦</span><span class="section-title">Ø¨Ù†ÙƒÙƒ:</span><p class="details">4648733 <button class="copy-btn" onclick="copyText('4648733')">ğŸ“‹ Ù†Ø³Ø®</button></p></div>
        <div class="section"><span class="icon">ğŸ“²</span><span class="section-title">Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø§Ù„ÙƒØªØ±ÙˆÙ†ÙŠÙ‡:</span><p class="details">01107199841 <button class="copy-btn" onclick="copyText('01107199841')">ğŸ“‹ Ù†Ø³Ø®</button></p></div>
        <div><button class="donate-button" onclick="openModal()">ğŸŒŸ Ø¥Ø±Ø³Ø§Ù„ ØªØ¨Ø±Ø¹</button></div>
      </div>

      <div class="footer">
        <p class="contact-info">Ù„Ù„Ø¥Ø³ØªÙØ³Ø§Ø± â€¢ +249 92 053 6546</p>
        <p class="tagline">ğŸ¤ ÙŠØ¯Ù‹Ø§ Ø¨ÙŠØ¯â€¦ Ø³ÙˆØ§ Ø¨Ù†Ù‚Ø¯Ø±ØŒ ÙˆØ³ÙˆØ§ Ø¨Ù†ØªØ®Ø·Ù‰ ğŸ’™</p>
      </div>
    </div>
  </div>
  <a href="https://wa.me/201107199841" class="whatsapp-float" target="_blank">ğŸ’¬</a>

  <!-- Modal -->
  <div class="modal" id="donationModal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">âœ–</span>
      <h3 style="text-align:center">Ù†Ù…ÙˆØ°Ø¬ ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØªØ¨Ø±Ø¹</h3>
      <div class="tabs">
        <div class="tab active" onclick="showForm('bankForm', this)">Ø¨Ù†ÙƒÙƒ</div>
        <div class="tab" onclick="showForm('walletForm', this)">Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</div>
      </div>
      <!-- Ø¨Ù†ÙƒÙƒ -->
      <form id="bankForm" class="active">
        <label>Ù‚ÙŠÙ…Ø© Ø§Ù„ØªØ¨Ø±Ø¹</label><input type="number" name="amount" placeholder="Ù‚ÙŠÙ…Ø© Ø§Ù„ØªØ¨Ø±Ø¹" required>
        <label>Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨</label><input type="text" name="account" value=""
placeholder="4648733"required>
        <label>Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¨Ø±Ø¹</label><input type="text" name="donor_name"
placeholder="Ø¥Ø³Ù… Ø§Ù„Ù…ØªØ¨Ø±Ø¹"required>
        <label>ØµÙˆØ±Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±</label><input type="file" name="receipt" accept="ØµÙˆØ±Ø©" required>
        <button type="submit">Ø¥Ø±Ø³Ø§Ù„</button>
      </form>
      <!-- Ø§Ù„Ù…Ø­ÙØ¸Ø© -->
      <form id="walletForm">
        <label>Ù‚ÙŠÙ…Ø© Ø§Ù„ØªØ¨Ø±Ø¹</label><input type="number" name="amount"
placeholder="Ù‚ÙŠÙ…Ø© Ø§Ù„ØªØ¨Ø±Ø¹"required>
        <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label><input type="text" name="number" placeholder="+249XXXXXXXXX" required>
        <label>Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¨Ø±Ø¹</label><input type="text" name="donor_name" placeholder="Ø¥Ø³Ù… Ø§Ù„Ù…ØªØ¨Ø±Ø¹"
required>
        <label>ØµÙˆØ±Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±</label><input type="file" name="receipt" accept="image/*" required>
        <button type="submit">Ø¥Ø±Ø³Ø§Ù„</button>
      </form>
    </div>
  </div>

  <script>
    const SUPABASE_URL = "https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2";
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhkYWNweGxycXducGF5ZHZ1ZGVsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk0OTgxMTUsImV4cCI6MjA3NTA3NDExNX0.eefcRkZWP3paICTClAuJ-yzoWKwPCOUiSN1POR_7qF8"; // Ø­Ø· Ø§Ù„Ù€ anon key ÙƒØ§Ù…Ù„ Ù‡Ù†Ø§
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    function copyText(text){ navigator.clipboard.writeText(text).then(()=>alert("ØªÙ… Ù†Ø³Ø®: " + text)); }
    function openModal(){ document.getElementById("donationModal").style.display="flex"; }
    function closeModal(){ document.getElementById("donationModal").style.display="none"; }
    function showForm(id,el){ document.querySelectorAll(".modal form").forEach(f=>f.classList.remove("active")); document.getElementById(id).classList.add("active"); document.querySelectorAll(".modal .tab").forEach(t=>t.classList.remove("active")); el.classList.add("active"); }

    // Ø­ÙØ¸ Ø§Ù„ØªØ¨Ø±Ø¹Ø§Øª
    async function handleDonation(form, type){
      const formData = new FormData(form);
      const amount = formData.get("amount");
      const name = formData.get("name");
      const account = formData.get("account") || null;
      const phone = formData.get("phone") || null;
      const receiptFile = formData.get("receipt");
      let receipt_url = null;

      if(receiptFile && receiptFile.size > 0){
        const fileName = `receipt_${Date.now()}.jpg`;
        const { data, error } = await supabase.storage.from("receipts").upload(fileName, receiptFile);
        if(!error) receipt_url = `${SUPABASE_URL}/storage/v1/object/public/receipts/${fileName}`;
      }

      const { error } = await supabase.from("donations").insert([{ donor_name:name, account, phone, amount, receipt_url }]);
      if(error){ alert("âŒ Ø®Ø·Ø£: " + error.message); console.log(error); }
      else { alert("âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØ¨Ø±Ø¹ Ø¨Ù†Ø¬Ø§Ø­"); form.reset(); closeModal(); }
    }

    document.getElementById("bankForm").addEventListener("submit",e=>{e.preventDefault();handleDonation(e.target,"bank");});
    document.getElementById("walletForm").addEventListener("submit",e=>{e.preventDefault();handleDonation(e.target,"wallet");});

    // Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ± ?admin=1
    (async ()=>{
      if(new URLSearchParams(window.location.search).get("admin")=="1"){
        const { data } = await supabase.from("donations").select("*").order("created_at",{ascending:false});
        document.body.innerHTML = "<h2 style='text-align:center'>ğŸ“Š Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ¨Ø±Ø¹Ø§Øª</h2><table border=1 style='width:100%;background:#fff'><tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ù…Ø¨Ù„Øº</th><th>Ø§Ù„Ø­Ø³Ø§Ø¨/Ø§Ù„Ù‡Ø§ØªÙ</th><th>Ø§Ù„ØµÙˆØ±Ø©</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th></tr>" +
          data.map(d=>`<tr><td>${d.donor_name||""}</td><td>${d.amount}</td><td>${d.account||d.phone||""}</td><td>${d.receipt_url?'<a href="'+d.receipt_url+'" target="_blank">ğŸ“</a>':""}</td><td>${d.created_at}</td></tr>`).join("")+"</table>";
      }
    })();
  </script>
</body>
</html>